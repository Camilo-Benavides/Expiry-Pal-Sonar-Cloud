/* Accessibility helper styles and runtime overrides */

/* HIGH CONTRAST MODES
   Provide two sensible high-contrast themes: dark (preferred by many a11y
   guidelines because it increases text/background contrast) and light
   (useful in some contexts). These override core tokens so components
   pick up the new colors. */
.a11y--high-contrast-dark{
  --md-sys-color-primary: #00B3A6; /* vivid accent */
  --md-sys-color-on-primary: #00201F;
  --md-sys-color-surface: #0B0B0B; /* very dark surface */
  --md-sys-color-on-surface: #FFFFFF; /* white text */
  --md-sys-color-outline-variant: rgba(255,255,255,0.12);
  --md-sys-color-background: #050505;
  /* accessibility border tokens for high contrast */
  --a11y-border-width: 3px;
  --a11y-border-color: var(--md-sys-color-on-surface);
  --a11y-focus-outline: 3px solid var(--md-sys-color-primary);
  /* primary container colors used by components like the empty state banner */
  --md-sys-color-primary-container: #004E4A; /* darker teal for dark surfaces */
  --md-sys-color-on-primary-container: #E6FFFB; /* light text on dark container */
  /* ensure surface-variant (muted text) is readable in dark HC */
  --md-sys-color-on-surface-variant: rgba(255,255,255,0.88);
  /* strong accent for icon/button in high-contrast dark (contrasts with white text) */
  --a11y-icon-bg: #003B36; /* darker teal square */
  --a11y-icon-on: #FFFFFF;
}
.a11y--high-contrast-light{
  --md-sys-color-primary: #003B3A;
  --md-sys-color-on-primary: #FFFFFF;
  --md-sys-color-surface: #FFFFFF;
  --md-sys-color-on-surface: #000000;
  --md-sys-color-outline-variant: #4A4A4A;
  --md-sys-color-background: #FFFFFF;
  /* accessibility border tokens for high contrast */
  --a11y-border-width: 3px;
  --a11y-border-color: var(--md-sys-color-on-surface);
  --a11y-focus-outline: 3px solid var(--md-sys-color-primary);
  /* light, minty container color for empty-banner in light high-contrast */
  --md-sys-color-primary-container: #BFFCF6; 
  --md-sys-color-on-primary-container: #002E2C;
  --md-sys-color-on-surface-variant: rgba(0,0,0,0.65);
  /* strong accent for icon/button in high-contrast light (contrasts with dark text) */
  --a11y-icon-bg: #00B39F; 
  --a11y-icon-on: #000000;
}

/* OpenDyslexic font . */
@font-face{
  font-family: 'OpenDyslexic';
  src: local('OpenDyslexic'), url('/src/assets/fonts/OpenDyslexic/OpenDyslexic-Regular.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face{
  font-family: 'OpenDyslexic';
  src: local('OpenDyslexic Bold'), url('/src/assets/fonts/OpenDyslexic/OpenDyslexic-Bold.woff2') format('woff2');
  font-weight: 700;
  font-style: bold;
  font-display: swap;
}

/* LARGE TEXT: scale base font-size and adjust token sizes for headings/body */
.a11y--large-text{
  /* apply on documentElement so rem-based sizes increase */
  font-size: 115%;
  --text-body: 1.15rem;
  --text-title: 2.1rem;
}

.a11y--grayscale{
  filter: grayscale(100%);
}

.a11y--dyslexic-font{
  /* prefer the OpenDyslexic font when available, otherwise fallback to system sans */
  --font-sans: 'OpenDyslexic', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
  /* also increase letter-spacing slightly for readability */
  letter-spacing: 0.01em;
}

/* Color-blind friendly palettes */
.a11y--cb-protanopia{
  /* Protanopia-safe palette (avoid red/green confusion): orange accent */
  --md-sys-color-primary: #E69F00; /* orange */
  --md-sys-color-on-primary: #061114;
  --md-sys-color-primary-container: #FFEAC9;
}
.a11y--cb-deuteranopia{
  /* Deuteranopia-safe palette: blue accent */
  --md-sys-color-primary: #56B4E9; /* sky blue */
  --md-sys-color-on-primary: #042231;
  --md-sys-color-primary-container: #DFF4FF;
}
.a11y--cb-tritanopia{
  --md-sys-color-primary: #D55E00;
  --md-sys-color-on-primary: #FFFFFF;
  --md-sys-color-primary-container: #FFEDE0;
}

/* Color-blind badge and accent overrides
   Some components still use semantic badge tokens (badge-fresh-bg etc.).
   For color-blind modes we remap those tokens to palettes that keep
   good contrast and avoid commonly-confused hues (red/green, blue/green).
   These improve readability on the Home screen where many badges and
   chips appear side-by-side. */
.a11y--cb-protanopia{
  /* protanopia: avoid reds (use blue/orange instead) */
  --badge-fresh-bg: #0072B2;    /* strong blue */
  --badge-fresh-color: #FFFFFF;
  --badge-soon-bg:  #E69F00;    /* orange */
  --badge-soon-color: #000000;
  --badge-danger-bg: #D55E00;   /* darker orange-red */
  --badge-danger-color: #FFFFFF;
  --badge-neutral-bg: #EAEFF2;
  --badge-neutral-color: #083042;
  --filter-selected-bg: #0072B2;
  --filter-selected-color: #FFFFFF;
}
.a11y--cb-deuteranopia{
  /* deuteranopia: use blue-accent palette to avoid green/red confusion */
  --badge-fresh-bg: #56B4E9; /* sky blue */
  --badge-fresh-color: #042231;
  --badge-soon-bg:  #F0A500; /* warm amber */
  --badge-soon-color: #000000;
  --badge-danger-bg: #D62828; /* deep red (still distinguishable) */
  --badge-danger-color: #FFFFFF;
  --badge-neutral-bg: #EAF6FB;
  --badge-neutral-color: #072536;
  --filter-selected-bg: #56B4E9;
  --filter-selected-color: #042231;
}
.a11y--cb-tritanopia{
  /* tritanopia (blue-weak): avoid blue/green confusion â€” prefer orange/purple */
  --badge-fresh-bg: #E69F00; /* orange */
  --badge-fresh-color: #061114;
  --badge-soon-bg:  #7E57C2; /* purple */
  --badge-soon-color: #FFFFFF;
  --badge-danger-bg: #D62828; /* red for urgency */
  --badge-danger-color: #FFFFFF;
  --badge-neutral-bg: #FFF3E0;
  --badge-neutral-color: #2E1F10;
  --filter-selected-bg: #7E57C2;
  --filter-selected-color: #FFFFFF;
}

/* Ensure keyboard focus is always visible for interactive controls across themes.
   Use :focus-visible so mouse clicks don't show outlines but keyboard users do. */
:where(.btn, .badge, a, button, input[type="checkbox"], .back-button, .textfield, .accessibility-fab, .access-fab):focus-visible{
  outline: 3px solid color-mix(in oklab, var(--md-sys-color-primary) 40%, var(--md-sys-color-on-surface));
  outline-offset: 2px;
}

/* Improve contrast of link text and small labels in accessibility modes */
.a11y--high-contrast-dark .link, .a11y--high-contrast-light .link,
.a11y--cb-protanopia .link, .a11y--cb-deuteranopia .link, .a11y--cb-tritanopia .link{
  color: var(--md-sys-color-primary);
  font-weight:700;
}

/* Make chip selected state use the accessibility-aware token so filters
   remain visible in color-blind modes */
.a11y--cb-protanopia .btn.chip-selected,
.a11y--cb-deuteranopia .btn.chip-selected,
.a11y--cb-tritanopia .btn.chip-selected{
  background: var(--filter-selected-bg);
  color: var(--filter-selected-color);
  border-color: transparent;
}

/* Floating accessibility FAB */
.accessibility-fab{
  position:fixed; top:14px; right:14px; z-index:1400;
  width:46px; height:46px; border-radius:10px; display:grid; place-items:center;
  background:var(--md-sys-color-primary); color:var(--md-sys-color-on-primary);
  box-shadow:var(--shadow-1); border:0; cursor:pointer;
}
.accessibility-fab:focus{ outline:3px solid color-mix(in oklab, var(--md-sys-color-primary) 40%, white); box-shadow:0 0 0 3px rgba(0,0,0,0.08); }

.accessibility-panel{
  position:fixed; top:72px; right:14px; z-index:1400; width:300px;
  background:var(--md-sys-color-surface); border-radius:12px; padding:12px;
  border:1px solid var(--md-sys-color-outline-variant); box-shadow:var(--shadow-2);
}
.accessibility-panel h3{
  margin:0 0 12px;
  font-size:1.15rem;
  font-weight:800;
  color:var(--md-sys-color-on-surface);
  text-align:center;
  padding:10px 0;
  /* use the normal panel background so it adapts with the page theme; when
    accessibility modes are enabled those variables change accordingly */
  background: var(--md-sys-color-surface);
  /* single separator line under the title */
  border-bottom:1px solid var(--md-sys-color-outline-variant);
}
.accessibility-row{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:6px 0 }
.accessibility-row label{ display:flex; align-items:center; gap:8px }
.accessibility-actions{ display:flex; gap:8px; margin-top:10px; justify-content:flex-end }

/* Make checkboxes larger/tappable */
.accessibility-panel input[type="checkbox"]{ width:18px; height:18px }

/* Style selects and range to match theme tokens so they remain readable
   in dark/high-contrast modes */
.accessibility-panel select,
.accessibility-panel input[type="range"]{
  background:var(--md-sys-color-surface);
  color:var(--md-sys-color-on-surface);
  border:1px solid var(--md-sys-color-outline-variant);
  border-radius:8px;
}
.accessibility-panel select option{
  background:var(--md-sys-color-surface);
  color:var(--md-sys-color-on-surface);
}
.accessibility-panel input[type="range"]{ width:160px; height:18px }

/* small responsive tweak */
@media (max-width:420px){ .accessibility-panel{ right:10px; left:10px; width:auto } }

/* Screen-reader only helper */
.sr-only{ position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }

/* Apply thicker, solid borders in high-contrast modes for key controls
   This increases the visual separation of interactive elements. We target
   common component classes used across the app and form controls. */
.a11y--high-contrast-dark .card,
.a11y--high-contrast-dark .btn,
.a11y--high-contrast-dark .oauth-btn,
.a11y--high-contrast-dark .textfield,
.a11y--high-contrast-dark .add-fridge-card,
.a11y--high-contrast-dark .accessibility-panel,
.a11y--high-contrast-dark input,
.a11y--high-contrast-dark select,
.a11y--high-contrast-dark textarea{
  border: var(--a11y-border-width,2px) solid var(--a11y-border-color, var(--md-sys-color-on-surface));
  box-shadow:none; /* reduce subtle shadows that can reduce clarity */
}

.a11y--high-contrast-light .card,
.a11y--high-contrast-light .btn,
.a11y--high-contrast-light .oauth-btn,
.a11y--high-contrast-light .textfield,
.a11y--high-contrast-light .add-fridge-card,
.a11y--high-contrast-light .accessibility-panel,
.a11y--high-contrast-light input,
.a11y--high-contrast-light select,
.a11y--high-contrast-light textarea{
  border: var(--a11y-border-width,2px) solid var(--a11y-border-color, var(--md-sys-color-on-surface));
  box-shadow:none;
}

/* stronger focus outline for keyboard users in high-contrast modes */
.a11y--high-contrast-dark :focus,
.a11y--high-contrast-light :focus{
  outline: var(--a11y-focus-outline, 3px solid var(--md-sys-color-primary));
  outline-offset:2px;
}
